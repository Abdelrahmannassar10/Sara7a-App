import { Router } from "express";
import * as authRouter from "./auth.service.js";
import { isValid } from "../../middleware/validation.middleware.js";
import { registerSchema  ,resetPasswordSchema} from "./auth.validation.js";
import { isAuthenticated } from "../../middleware/auth.middleware.js";
const router = Router();
router.post("/register",isValid(registerSchema), authRouter.register);
router.post("/login", authRouter.login);
router.post("/verify-account", authRouter.verifyAccount);
router.post("/sendOTP", authRouter.sendOtp);
router.post("/google-login", authRouter.loginWithGoogle);
router.post("/refresh-token", isAuthenticated, authRouter.refresh_Token);
router.post("/update-password", isAuthenticated, authRouter.updatePassword);
router.patch("/resetPassword" ,isValid(resetPasswordSchema) ,authRouter.resetPassword);
router.get("/logout", isAuthenticated, authRouter.logout);
export default router;